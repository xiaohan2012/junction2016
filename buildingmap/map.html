
<!DOCTYPE html>
<meta charset="utf-8">
<html>
  <head>
    <style>
    #demo{
      margin-top:70px;
      margin-left:320px;
    }

    #opts{
      margin-left:300px;
      margin-top:100px;
    }

    </style>

    <!-- add css external files-->
    <link rel="stylesheet" type="text/css" href="css/d3.floorplan.css" media="screen">

    <!-- add js external files -->
    <script src="http://d3js.org/d3.v3.js"></script>
    <script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
    <script src="js/d3.floorplan.min.js" type="text/javascript"></script>
    <script src="js/floorplan.js" type="text/javascript"></script>
    <script src="js/heatmap.js" type="text/javascript"></script>
    <script src="js/imagelayer.js" type="text/javascript"></script>
    <script src="js/overlays.js" type="text/javascript"></script>
    <script src="js/pathplot.js" type="text/javascript"></script>
    <script src="js/vectorfield.js" type="text/javascript"></script>
  </head>
  <body>
   <select id = "opts">
        <option value="1stfloor" selected="selected">1st floor indoor map</option>
        <option value="2ndfloor">2nd floor indoor map</option>
      </select>
    <div id="demo"> </div>
    <script type="text/javascript">

    var xscale = d3.scale.linear()
                   .domain([0,50.0])
                   .range([0,720]),
        yscale = d3.scale.linear()
                   .domain([0,63.79])
                   .range([0,487]),
        map = d3.floorplan().xScale(xscale).yScale(yscale),
        imagelayer = d3.floorplan.imagelayer(),
        heatmap = d3.floorplan.heatmap(),
        vectorfield = d3.floorplan.vectorfield(),
        pathplot = d3.floorplan.pathplot(),
        overlays = d3.floorplan.overlays().editMode(true),
        mapdata = {};

    function drawmap(map_to_display){

      mapdata[imagelayer.id()] = [{
        url: map_to_display,
        x: 0,
        y: 0,
        height: 63.79,
        width: 50.0
         }];

      map.addLayer(imagelayer)
       .addLayer(pathplot)

      d3.json("data/demo-data.json", function(data) {
        mapdata[heatmap.id()] = data.heatmap;
        mapdata[overlays.id()] = data.overlays;
        mapdata[vectorfield.id()] = data.vectorfield;
        mapdata[pathplot.id()] = data.pathplot;
        
        d3.select("#demo").append("svg")
          .attr("height", 487).attr("width",720)
          .datum(mapdata).call(map);
      });

    }

    drawmap("imgs/floor_map.jpg");

      d3.selectAll("#opts")
        .on('change', function() {
        var ID = d3.select(this).property('value');
        if (ID == "1stfloor"){
          d3.select("svg").remove();
          drawmap("imgs/floor_map.jpg")
        }
        else if (ID == "2ndfloor"){
          d3.select("svg").remove();
          drawmap("imgs/floor_map.jpg")

        }
                         
      });

    </script>
  </body>
</html>